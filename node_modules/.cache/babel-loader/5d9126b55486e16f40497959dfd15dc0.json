{"ast":null,"code":"import _asyncToGenerator from\"D:/projects/noteApp/app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _objectSpread from\"D:/projects/noteApp/app/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"D:/projects/noteApp/app/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"D:\\\\projects\\\\noteApp\\\\app\\\\node_modules\\\\@babel\\\\runtime\\\\regenerator\\\\index.js\";import React,{useState}from'react';import axios from'axios';import Joi from'joi';import{useNavigate}from'react-router-dom';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function Login(props){var navigate=useNavigate();var _useState=useState(''),_useState2=_slicedToArray(_useState,2),erro=_useState2[0],seterro=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),isloading=_useState4[0],setisloading=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),errolist=_useState6[0],seterrolist=_useState6[1];var _useState7=useState({email:'',password:''}),_useState8=_slicedToArray(_useState7,2),user=_useState8[0],setuser=_useState8[1];function getUser(e){var myuser=_objectSpread({},user);myuser[e.target.name]=e.target.value;setuser(myuser);}function submitRigister(_x){return _submitRigister.apply(this,arguments);}function _submitRigister(){_submitRigister=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(e){var validationResult,_yield$axios$post,data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:e.preventDefault();validationResult=validateLoginForm(user);if(!validationResult.error){_context.next=7;break;}setisloading(false);seterrolist(validationResult.error.details);_context.next=12;break;case 7:_context.next=9;return axios.post(\"https://route-egypt-api.herokuapp.com/signin\",user);case 9:_yield$axios$post=_context.sent;data=_yield$axios$post.data;if(data.message==='success'){localStorage.setItem('userToken',data.token);setisloading(false);props.getuser();navigate('/Home');}else{seterro(data.message);setisloading(false);}case 12:case\"end\":return _context.stop();}}},_callee);}));return _submitRigister.apply(this,arguments);}function validateLoginForm(user){var schema=Joi.object({email:Joi.string().email({minDomainSegments:2,tlds:{allow:['com','net']}}),password:Joi.string().pattern(/^[A-Z][a-z]{3,8}$/)});return schema.validate(user,{abortEarly:false});}return/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(\"div\",{className:\"container my-5 py-5\",children:[errolist.map(function(erro,index){if(index==4){return/*#__PURE__*/_jsx(\"div\",{className:\"alert alert-danger\",children:\" password invalid\"},index);}else{return/*#__PURE__*/_jsx(\"div\",{className:\"alert alert-danger\",children:erro.message},index);}}),/*#__PURE__*/_jsx(\"div\",{className:\"col-md-5 m-auto text-center\",children:/*#__PURE__*/_jsxs(\"form\",{onSubmit:submitRigister,children:[/*#__PURE__*/_jsx(\"div\",{className:\"form-group\",children:/*#__PURE__*/_jsx(\"input\",{onChange:getUser,placeholder:\"Enter email\",type:\"email\",name:\"email\",className:\"form-control\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"form-group my-2\",children:/*#__PURE__*/_jsx(\"input\",{onChange:getUser,placeholder:\"Enter you password\",type:\"password\",name:\"password\",className:\" form-control\"})}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"btn btn-info\",children:isloading?/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-spinner fa-spin\"}):'Login'}),erro&&/*#__PURE__*/_jsx(\"div\",{className:\"alert alert-danger\",children:erro})]})})]})});}","map":{"version":3,"sources":["D:/projects/noteApp/app/src/componet/Login/Login.jsx"],"names":["React","useState","axios","Joi","useNavigate","Login","props","navigate","erro","seterro","isloading","setisloading","errolist","seterrolist","email","password","user","setuser","getUser","e","myuser","target","name","value","submitRigister","preventDefault","validationResult","validateLoginForm","error","details","post","data","message","localStorage","setItem","token","getuser","schema","object","string","minDomainSegments","tlds","allow","pattern","validate","abortEarly","map","index"],"mappings":"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","sourcesContent":["import React, { useState } from 'react'\r\nimport axios from 'axios'\r\nimport Joi from 'joi'\r\nimport {useNavigate} from 'react-router-dom'\r\nexport default function Login(props) {\r\n    let navigate=useNavigate()\r\n    const [erro, seterro] = useState('')\r\n    const [isloading, setisloading] = useState(false)\r\n    const [errolist, seterrolist] = useState([])\r\n\r\nconst [user, setuser] = useState({\r\n  \r\n  \r\n    email:'',\r\n    password:'',\r\n\r\n})\r\nfunction getUser(e) {\r\n    let myuser={...user}\r\n    myuser[e.target.name]=e.target.value;\r\n    setuser(myuser)\r\n}\r\n\r\nasync function submitRigister(e) {\r\n    e.preventDefault() \r\n\r\n    let validationResult=validateLoginForm(user)\r\n\r\n    if(validationResult.error)\r\n    {\r\n        setisloading(false)\r\n         seterrolist(validationResult.error.details)\r\n    }\r\n    else\r\n    {\r\n        let {data} =await axios.post(\"https://route-egypt-api.herokuapp.com/signin\",user)\r\n\r\n        if (data.message==='success') {\r\n            localStorage.setItem('userToken',data.token)\r\n         setisloading(false)\r\n         props.getuser()\r\nnavigate('/Home')\r\n\r\n        }\r\n        else{\r\n            seterro(data.message)\r\n            setisloading(false)\r\n        }\r\n    }\r\n  \r\n}\r\n\r\nfunction validateLoginForm(user) {\r\n    let schema = Joi.object({\r\n      email: Joi.string().email({ minDomainSegments: 2, tlds: { allow: ['com', 'net'] } }),\r\n      password: Joi.string().pattern(/^[A-Z][a-z]{3,8}$/),\r\n    });\r\n    return schema.validate(user,{abortEarly:false});\r\n  }\r\n  return (\r\n    <div>\r\n\r\n\r\n<div className=\"container my-5 py-5\">\r\n{errolist.map((erro,index)=>{\r\nif (index ==4)\r\n {\r\n    return <div key={index} className='alert alert-danger'> password invalid</div>\r\n}\r\nelse\r\n{\r\nreturn <div key={index} className='alert alert-danger'>{erro.message}</div>\r\n}\r\n\r\n})}\r\n                <div className=\"col-md-5 m-auto text-center\">\r\n                \r\n                    <form onSubmit={submitRigister} >\r\n                        <div className=\"form-group\">\r\n                            <input onChange={getUser}  placeholder=\"Enter email\" type=\"email\" name=\"email\" className=\"form-control\" />\r\n                        </div>\r\n                        <div className=\"form-group my-2\">\r\n                            <input onChange={getUser}  placeholder=\"Enter you password\" type=\"password\" name=\"password\" className=\" form-control\" />\r\n                        </div>\r\n                       \r\n                        <button type='submit' className='btn btn-info'>{isloading?<i className='fas fa-spinner fa-spin'></i>:'Login'}</button>\r\n                        {erro&&<div className='alert alert-danger'>{erro}</div>}\r\n                    </form>\r\n                </div>\r\n            </div>\r\n\r\n\r\n\r\n\r\n\r\n    </div>\r\n  )\r\n}\r\n"]},"metadata":{},"sourceType":"module"}